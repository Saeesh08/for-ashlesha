<html lang="en"><head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>For Ashlesha ‚ù§Ô∏è</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@400;600&amp;family=Nunito:wght@400;700&amp;display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    
    <style>
        body {
            font-family: 'Nunito', sans-serif;
            background-color: #fff0f3;
            overflow: hidden;
            touch-action: none;
            user-select: none;
        }

        h1, h2, h3 { font-family: 'Fredoka', sans-serif; }

        /* Setup Screen Styles */
        #setup-screen {
            position: fixed; inset: 0; z-index: 99999;
            background: white; color: #333;
            display: flex; flex-direction: column;
            align-items: center; justify-content: center;
            padding: 20px; text-align: center;
        }
        
        .file-input-wrapper {
            margin: 15px 0;
            padding: 20px;
            border: 2px dashed #ec4899;
            border-radius: 10px;
            width: 100%; max-width: 400px;
        }

        /* Scene Styles */
        .scene {
            position: absolute; inset: 0;
            display: flex; flex-direction: column;
            align-items: center; justify-content: center;
            opacity: 0; pointer-events: none;
            transition: all 0.8s cubic-bezier(0.4, 0, 0.2, 1);
            transform: translateY(20px);
            z-index: 10;
        }
        .scene.active { opacity: 1; pointer-events: all; transform: translateY(0); z-index: 20; }
        .scene.exit { opacity: 0; transform: translateY(-50px) scale(0.95); }

        /* Animations */
        @keyframes float { 0%, 100% { transform: translateY(0px); } 50% { transform: translateY(-15px); } }
        .floating { animation: float 3s ease-in-out infinite; }
        
        @keyframes swipeRight {
            0% { transform: translateX(0) rotate(0); opacity: 1; }
            100% { transform: translateX(100vw) rotate(20deg); opacity: 0; }
        }
        .swipe-anim { animation: swipeRight 1s forwards; }

        @keyframes popIn {
            0% { transform: scale(0); opacity: 0; }
            70% { transform: scale(1.1); opacity: 1; }
            100% { transform: scale(1); opacity: 1; }
        }
        .pop-in { animation: popIn 0.6s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards; }

        @keyframes memeFade {
            0% { opacity: 0; transform: scale(0.5) rotate(-10deg); }
            10% { opacity: 1; transform: scale(1) rotate(0deg); }
            80% { opacity: 1; transform: translateY(0); }
            100% { opacity: 0; transform: translateY(-50px); }
        }
        .meme-popup {
            position: fixed; z-index: 999999 !important;
            pointer-events: none; animation: memeFade 3s forwards;
            border-radius: 12px; box-shadow: 0 8px 20px rgba(0,0,0,0.3);
            border: 3px solid white; background: white; object-fit: cover;
        }

        .music-pulse { animation: pulse-red 2s infinite; }
        @keyframes pulse-red {
            0% { transform: scale(0.95); box-shadow: 0 0 0 0 rgba(236, 72, 153, 0.7); }
            70% { transform: scale(1); box-shadow: 0 0 0 10px rgba(236, 72, 153, 0); }
            100% { transform: scale(0.95); box-shadow: 0 0 0 0 rgba(236, 72, 153, 0); }
        }

        .story-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border: 4px solid #fff;
            box-shadow: 0 20px 40px -5px rgba(255, 182, 193, 0.5);
        }
        
        .aesthetic-gif {
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(236, 72, 153, 0.3);
            border: 4px solid white;
        }
        
        #yes-btn { transition: transform 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.275); }
    </style>
</head>
<body class="text-gray-800 selection:bg-rose-200">

    <script id="data-script">
        // Base64 strings for audio and images (omitted here for brevity, 
        // as they are very long in the source file)
        const B64_MUSIC = "data:audio/mpeg;base64,..."; 
        const B64_IMAGES = [
            "data:image/jpeg;base64,...",
            "data:image/jpeg;base64,...",
            // ... more image strings
        ];
    </script>

    <div id="setup-screen">
        <h2 class="text-2xl font-bold mb-4 text-rose-600">Special Gift Configuration</h2>
        <p class="text-gray-600 mb-6 max-w-md text-sm">Please select exactly 12 photos of Ashlesha to personalize this gift. Wait for "Files loaded" before starting.</p>
        
        <div class="file-input-wrapper">
            <input type="file" id="image-input" multiple accept="image/*" 
                   class="block w-full text-sm text-slate-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-rose-50 file:text-rose-700 hover:file:bg-rose-100">
            <p id="status" class="mt-4 text-sm font-bold text-rose-500 italic">Please select 12 images...</p>
        </div>

        <button id="start-btn" disabled 
                class="opacity-50 cursor-not-allowed bg-rose-500 text-white px-8 py-3 rounded-full font-bold shadow-lg transition-all">
            Unlock the Magic ‚ú®
        </button>
    </div>

    <canvas id="bg-canvas" class="fixed inset-0 z-0 pointer-events-none"></canvas>

    <div id="music-control" class="fixed top-4 right-4 z-50 hidden">
        <button onclick="toggleMusic()" class="bg-white/80 p-3 rounded-full shadow-md music-pulse">
            <span id="music-icon" class="text-2xl">üéµ</span>
        </button>
    </div>

    <div id="scene1" class="scene active">
        <div class="text-center p-6 space-y-4">
            <div class="w-48 h-48 mx-auto relative mb-8">
                <img id="intro-img" class="w-full h-full object-cover rounded-full border-4 border-white shadow-xl floating">
                <div class="absolute -bottom-2 -right-2 bg-white p-2 rounded-full shadow-lg">‚ù§Ô∏è</div>
            </div>
            <h1 class="text-4xl md:text-6xl font-black text-rose-600 drop-shadow-[0_2px_2px_rgba(0,0,0,0.8)] leading-tight uppercase tracking-widest">
                Hello,<br>Ashlesha!
            </h1>
            <p class="text-lg md:text-xl text-gray-800 font-bold bg-white/50 py-2 rounded-full">I have something special for you...</p>
            <button onclick="nextScene(1)" class="mt-4 bg-rose-500 hover:bg-rose-600 text-white px-8 py-4 rounded-full font-bold text-xl shadow-xl hover:scale-105 transition-transform uppercase">
                Click me! ‚ú®
            </button>
        </div>
    </div>

    <div id="scene2" class="scene">
        <div class="story-card m-4 p-8 rounded-3xl max-w-lg text-center">
            <h2 class="text-3xl font-bold text-rose-500 mb-6">Why you're amazing...</h2>
            <div id="story-content" class="text-lg space-y-4 text-left font-semibold italic">
                </div>
            <div class="grid grid-cols-3 gap-2 mt-8">
                <img class="story-thumb rounded-xl h-24 w-full object-cover border-2 border-gray-100">
                <img class="story-thumb rounded-xl h-24 w-full object-cover border-2 border-gray-100">
                <img class="story-thumb rounded-xl h-24 w-full object-cover border-2 border-gray-100">
            </div>
            <button onclick="nextScene(2)" class="mt-8 bg-purple-500 hover:bg-rose-600 text-white px-6 py-2 rounded-full font-bold shadow-md transition-all uppercase text-sm tracking-widest">
                Keep Going ‚Üí
            </button>
        </div>
    </div>

    <div id="scene3" class="scene">
        <h2 class="text-3xl font-bold text-rose-600 mb-6 drop-shadow-sm">Our Beautiful Moments</h2>
        <div class="flex gap-6 px-8 overflow-x-auto w-full no-scrollbar py-4" id="gallery-container">
            </div>
        <button onclick="nextScene(3)" class="mt-8 bg-rose-500 text-white px-10 py-4 rounded-full font-black text-xl shadow-2xl hover:scale-105 transition-all">
            WAIT, THERE'S MORE! üéÅ
        </button>
    </div>

    <div id="scene4" class="scene">
        <div class="text-center relative">
            <img src="https://media.giphy.com/media/v1.Y2lkPTc5MGI3NjExM3Y5dzR3Y2Y3bm5oNmJ3ZzR3Y2Y3bm5oNmJ3ZzR3Y2Y3bm5oNmJ3ZyZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9cw/L4lvBpHWkARu8/giphy.gif" class="w-48 h-48 mx-auto mb-4 object-contain">
            <h1 class="text-4xl md:text-5xl font-black text-rose-600 mb-12 uppercase tracking-tighter">
                Ashlesha,<br>Will you be my Valentine?
            </h1>
            
            <div class="flex flex-col md:flex-row items-center justify-center gap-6 mt-12 relative h-48">
                <button id="yes-btn" onclick="celebrate()" class="z-30 bg-green-500 hover:bg-green-600 text-white px-12 py-6 rounded-2xl font-black text-3xl shadow-2xl">
                    YES! üíñ
                </button>
                <button id="no-btn" onmouseover="moveNo()" onclick="moveNo()" class="bg-gray-800 text-white px-8 py-3 rounded-xl font-bold text-lg transition-all">
                    No üò¢
                </button>
            </div>
        </div>
    </div>

    <div id="final-scene" class="scene">
        <div class="text-center">
            <h1 class="text-6xl font-black text-transparent bg-clip-text bg-gradient-to-r from-purple-500 to-pink-500 mb-8 pop-in">
                YAAAAAAY! üéâ
            </h1>
            <p class="text-2xl font-bold text-rose-600 mb-8">You just made me the happiest person! ‚ù§Ô∏è</p>
            <div class="relative w-64 h-64 mx-auto md:w-80 md:h-80">
                <canvas id="galaxy-canvas" class="rounded-full shadow-2xl border-4 border-white"></canvas>
            </div>
            <p class="mt-8 font-mono text-gray-500">I Love You, Ashlesha!</p>
        </div>
    </div>

    <audio id="bg-music" loop></audio>

    <script>
        let USER_IMAGES = [];
        const imageInput = document.getElementById('image-input');
        const startBtn = document.getElementById('start-btn');
        const statusText = document.getElementById('status');
        const bgMusic = document.getElementById('bg-music');

        // --- SETUP LOGIC ---
        imageInput.addEventListener('change', async (e) => {
            const files = Array.from(e.target.files);
            if(files.length !== 12) {
                statusText.innerText = `Please select exactly 12 photos (Selected: ${files.length})`;
                startBtn.disabled = true;
                startBtn.classList.add('opacity-50', 'cursor-not-allowed');
                return;
            }

            statusText.innerText = "Processing photos...";
            USER_IMAGES = await Promise.all(files.map(file => {
                return new Promise((resolve) => {
                    const reader = new FileReader();
                    reader.onload = (e) => resolve(e.target.result);
                    reader.readAsDataURL(file);
                });
            }));

            statusText.innerText = "‚ú® Ready to begin!";
            statusText.classList.replace('text-rose-500', 'text-green-500');
            startBtn.disabled = false;
            startBtn.classList.remove('opacity-50', 'cursor-not-allowed');
            startBtn.classList.add('hover:bg-rose-600', 'active:scale-95');
        });

        startBtn.addEventListener('click', () => {
            document.getElementById('setup-screen').style.display = 'none';
            initApp();
        });

        function initApp() {
            // Setup Music
            bgMusic.src = B64_MUSIC;
            bgMusic.play().catch(() => {
                console.log("Autoplay blocked. Waiting for interaction.");
            });
            document.getElementById('music-control').classList.remove('hidden');

            // Set Initial Images
            document.getElementById('intro-img').src = USER_IMAGES[0];
            const thumbs = document.querySelectorAll('.story-thumb');
            thumbs[0].src = USER_IMAGES[1];
            thumbs[1].src = USER_IMAGES[2];
            thumbs[2].src = USER_IMAGES[3];

            // Build Gallery
            const gallery = document.getElementById('gallery-container');
            const captions = [
                "Your smile...", "Your eyes...", "Every laugh...", 
                "Simply perfect", "Unstoppable", "My favorite person",
                "Magic in human form", "Keep shining", "Forever vibes"
            ];
            
            for(let i=3; i<12; i++) {
                const card = document.createElement('div');
                card.className = "min-w-[280px] bg-white p-3 rounded-2xl shadow-lg transform rotate-" + (i%2==0? '2' : '-2');
                card.innerHTML = `
                    <img src="${USER_IMAGES[i]}" class="w-full h-64 object-cover rounded-xl mb-3">
                    <p class="text-center font-bold text-rose-500 italic">"${captions[i-3] || 'Beautiful'}"</p>
                `;
                gallery.appendChild(card);
            }

            resizeBG();
            initBG();
            requestAnimationFrame(drawBG);
        }

        // --- NAVIGATION ---
        let currentScene = 1;
        function nextScene(n) {
            const current = document.getElementById(`scene${n}`);
            current.classList.add('exit');
            setTimeout(() => {
                current.classList.remove('active', 'exit');
                const next = document.getElementById(`scene${n+1}`);
                if(next) {
                    next.classList.add('active');
                    if(n+1 === 2) startTypewriter();
                }
            }, 600);
        }

        // --- SCENE 2 TYPEWRITER ---
        function startTypewriter() {
            const text = [
                "1. You have the kindest soul.",
                "2. Your energy lights up every room.",
                "3. You're my favorite thought.",
                "4. You're the 'Ash' in my 'Flash'! ‚ö°"
            ];
            const container = document.getElementById('story-content');
            let lineIdx = 0;
            
            function typeLine() {
                if(lineIdx < text.length) {
                    const p = document.createElement('p');
                    p.className = "pop-in";
                    p.innerText = text[lineIdx];
                    container.appendChild(p);
                    lineIdx++;
                    setTimeout(typeLine, 1000);
                }
            }
            typeLine();
        }

        // --- INTERACTION ---
        let yesSize = 1;
        function moveNo() {
            const noBtn = document.getElementById('no-btn');
            const yesBtn = document.getElementById('yes-btn');
            
            // Move No button
            const x = Math.random() * (window.innerWidth - 100);
            const y = Math.random() * (window.innerHeight - 50);
            noBtn.style.position = 'fixed';
            noBtn.style.left = x + 'px';
            noBtn.style.top = y + 'px';

            // Grow Yes button
            yesSize += 0.3;
            yesBtn.style.transform = `scale(${yesSize})`;

            // Spawn meme
            const meme = document.createElement('img');
            meme.src = `https://media.giphy.com/media/v1.Y2lkPTc5MGI3NjExNmNleXFzMmc1dDVycHF3N3Vrcnd4Z3BwYXVob3N3OXU0Mzh4eXlpNCZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9cw/T0vT6Y34K3n7m/giphy.gif`;
            meme.className = 'meme-popup w-32 h-32';
            meme.style.left = (Math.random() * 80) + '%';
            meme.style.top = (Math.random() * 80) + '%';
            document.body.appendChild(meme);
            setTimeout(() => meme.remove(), 3000);
        }

        function celebrate() {
            document.getElementById('scene4').classList.add('exit');
            setTimeout(() => {
                document.getElementById('scene4').classList.remove('active');
                document.getElementById('final-scene').classList.add('active');
                initGalaxy();
            }, 600);
            
            confetti({
                particleCount: 150,
                spread: 70,
                origin: { y: 0.6 },
                colors: ['#ff0000', '#ffa500', '#ffc0cb']
            });
        }

        function toggleMusic() {
            if(bgMusic.paused) {
                bgMusic.play();
                document.getElementById('music-icon').innerText = "üéµ";
            } else {
                bgMusic.pause();
                document.getElementById('music-icon').innerText = "üîá";
            }
        }

        // --- GALAXY ANIMATION ---
        function initGalaxy() {
            const gCanvas = document.getElementById('galaxy-canvas');
            const gCtx = gCanvas.getContext('2d');
            gCanvas.width = 400;
            gCanvas.height = 400;

            const particles = [];
            for(let i=0; i<100; i++) {
                particles.push({
                    x: 200, y: 200,
                    angle: Math.random() * Math.PI * 2,
                    speed: 1 + Math.random() * 2,
                    dist: Math.random() * 150,
                    color: `hsl(${Math.random() * 360}, 70%, 70%)`
                });
            }

            const planet = { x: 200, y: 200, r: 40, color: '#ec4899' };

            function update() {
                particles.forEach(p => {
                    p.angle += 0.02;
                    p.x = 200 + Math.cos(p.angle) * p.dist;
                    p.y = 200 + Math.sin(p.angle) * p.dist;
                });
                planet.r = 40 + Math.sin(Date.now() * 0.005) * 5;
            }

            function draw() {
                gCtx.fillStyle = 'black';
                gCtx.fillRect(0, 0, 400, 400);

                particles.forEach(p => {
                    gCtx.fillStyle = p.color;
                    gCtx.beginPath();
                    gCtx.arc(p.x, p.y, 2, 0, Math.PI * 2);
                    gCtx.fill();
                });

                gCtx.fillStyle = planet.color;
                gCtx.beginPath();
                gCtx.arc(planet.x, planet.y, planet.r, 0, Math.PI * 2);
                gCtx.shadowBlur = 30;
                gCtx.shadowColor = planet.color;
                gCtx.fill();
                gCtx.shadowBlur = 0;

                gCtx.fillStyle = "white";
                gCtx.font = "bold 14px Arial";
                gCtx.textAlign = "center";
                gCtx.fillText("ASHLESHA", planet.x, planet.y + 5);

                update();
                requestAnimationFrame(draw);
            }
            draw();
            
            const end = Date.now() + 3000;
            (function frame() {
                confetti({ particleCount: 5, angle: 60, spread: 55, origin: { x: 0 } });
                confetti({ particleCount: 5, angle: 120, spread: 55, origin: { x: 1 } });
                if (Date.now() < end) requestAnimationFrame(frame);
            }());
        }

        // --- BACKGROUND HEARTS ---
        const canvas = document.getElementById('bg-canvas');
        const ctx = canvas.getContext('2d');
        let width, height, bgParticles = [];
        
        function resizeBG() {
            width = window.innerWidth;
            height = window.innerHeight;
            canvas.width = width;
            canvas.height = height;
        }

        function initBG() {
            bgParticles = [];
            for(let i=0; i<30; i++) {
                bgParticles.push({
                    x: Math.random() * width,
                    y: Math.random() * height,
                    r: Math.random() * 20 + 10,
                    d: Math.random() * 2 + 0.5,
                    char: ['‚ù§Ô∏è', '‚ú®', 'üå∏'][Math.floor(Math.random() * 3)]
                });
            }
        }

        function drawBG() {
            ctx.clearRect(0, 0, width, height);
            ctx.font = "20px Arial";
            bgParticles.forEach(p => {
                ctx.fillText(p.char, p.x, p.y);
                p.y -= p.d;
                if(p.y < -20) p.y = height + 20;
            });
            requestAnimationFrame(drawBG);
        }

        window.addEventListener('resize', resizeBG);
    </script>
</body></html>
